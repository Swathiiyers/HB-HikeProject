{% extends 'base.html' %}
{% block title %}Results Page{% endblock %}

   {% block content %}

    {% if "user_name" in session %}
    <h2> Hey, {{ session["user_name"] }}</h2>
    {% endif %}

    <div id="map" align="center">           
        <script>
          function initMap() {
          // Taking the latlong dict values from python function
          var locArray = {{ latlong_list|tojson }};
          // adding the center of the search place to the first marker out of the list
          var locCenter= locArray[0];
          console.log(locArray);
          var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 4,
            center: locCenter
          });
          for (var i = 0; i < locArray.length; i++){
          var marker = new google.maps.Marker({
            position: locArray[i],
            map: map
            });
         }  //End of for loop
    }
        </script>
        <script src="https://maps.googleapis.com/maps/api/js?key={{ google_map_key }}&callback=initMap"
        async defer></script>  
    </div>


    {% if result_list | length == 0 %}
        <p> Sorry, there are no hikes listed :(</p>

    {% else %}
    <p> The results are: </p>
        {% for result in result_list %}
        <ul>
            <li>Trail: {{ (result["name"]) }}</li>
            <li>Hiking Trail ID: {{ (result["unique_id"]) }}</li>
            <li>Description: {{ result["activities"][0]["description"] }}</li>
            <li>url: {{ result['activities'][0]['url'] }} </li>
            <li>Length: {{ result["activities"][0]["length"] }}</li>


        </ul>
        {% endfor %}
    {% endif %}



    {% if "user_name" in session %}
    <div align="center">
    <form action="/save-search" method = "POST">
    <input type="submit" id="save" name="save-search" value="Save searches" align="center" />
    <input type = "hidden" name="city" value="{{ city }}">
    <input type = "hidden" name="state" value="{{ state }}">
    <input type = "hidden" name="radius" value="{{ radius }}">
    <input type = "hidden" name="curr-lat" value="{{ curr_lat }}">
    <input type = "hidden" name="curr-long" value="{{ curr_long }}">
    <input type = "hidden" name="name" value="{{ session['user_name'] }}">

    </form>
    </div>
    {% endif %}   



   {% endblock %}